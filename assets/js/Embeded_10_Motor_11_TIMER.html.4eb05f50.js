"use strict";(self.webpackChunkstudy_notes=self.webpackChunkstudy_notes||[]).push([[5489],{7416:(a,e,s)=>{s.r(e),s.d(e,{comp:()=>u,data:()=>T});var n=s(362);const p=s.p+"assets/img/6cb189ef79e260e284af8b812d135f9ba30d782e.ed2d55fc.png",i=s.p+"assets/img/基础定时器框图.582abab8.png",h=s.p+"assets/img/基础定时器寄存器.ea3a9f5d.png",r=s.p+"assets/img/image-20250223214312332.574c0973.png",t=s.p+"assets/img/通用定时器框图.0b098181.png",l=s.p+"assets/img/高级定时器框图.47674e92.png",d=s.p+"assets/img/image-20250222232421628.169e09ed.png",c=s.p+"assets/img/image-20250222232726964.727172d5.png",g=s.p+"assets/img/image-20250223211052829.d712583d.png",m=s.p+"assets/img/image-20250223141011548.48603fde.png",o=s.p+"assets/img/image-20250223144518942.564dc7ab.png",x=s.p+"assets/img/image-20250223144541346.affbd947.png",f=s.p+"assets/img/image-20250223144614150.5fa4fa54.png",b=s.p+"assets/img/高级定时器寄存器.6d14f68a.png",_={},u=(0,s(5726).A)(_,[["render",function(a,e){return(0,n.uX)(),(0,n.CE)("div",null,[...e[0]||(e[0]=[(0,n.Fv)('<h1 id="f1xx定时器" tabindex="-1"><a class="header-anchor" href="#f1xx定时器"><span>F1xx定时器</span></a></h1><h2 id="f1定时器定时器通道映射" tabindex="-1"><a class="header-anchor" href="#f1定时器定时器通道映射"><span>F1定时器定时器通道映射</span></a></h2><p><img src="'+p+'" alt=""></p><h1 id="基本定时器" tabindex="-1"><a class="header-anchor" href="#基本定时器"><span>基本定时器</span></a></h1><h2 id="基础定时器简介" tabindex="-1"><a class="header-anchor" href="#基础定时器简介"><span>基础定时器简介</span></a></h2><h2 id="基础定时器框图" tabindex="-1"><a class="header-anchor" href="#基础定时器框图"><span>基础定时器框图</span></a></h2><h3 id="_0-总框图" tabindex="-1"><a class="header-anchor" href="#_0-总框图"><span>0.总框图</span></a></h3><p><img src="'+i+'" alt="image-20250222213201301"></p><h3 id="_1-时钟源" tabindex="-1"><a class="header-anchor" href="#_1-时钟源"><span>1.时钟源</span></a></h3><h3 id="_2-控制器" tabindex="-1"><a class="header-anchor" href="#_2-控制器"><span>2.控制器</span></a></h3><h3 id="_3-计数器" tabindex="-1"><a class="header-anchor" href="#_3-计数器"><span>3.计数器</span></a></h3><h2 id="基础定时器寄存器" tabindex="-1"><a class="header-anchor" href="#基础定时器寄存器"><span>基础定时器寄存器</span></a></h2><p><img src="'+h+'" alt="image-20250222214036519"></p><h5 id="控制寄存器-timx-cr1" tabindex="-1"><a class="header-anchor" href="#控制寄存器-timx-cr1"><span>控制寄存器 - TIMx_CR1</span></a></h5><p><strong>ARPE</strong>：自动重装载预装载使能 (Auto-reload preload enable) 位6:4</p><p>0：TIMx_ARR寄存器没有缓冲</p><p>1：TIMx_ARR寄存器具有缓冲</p><p><strong>OPM</strong>：单脉冲模式 (One-pulse mode)</p><p>0：在发生更新事件时，计数器不停止</p><p>1：在发生下次更新事件时，计数器停止计数(清除CEN位)。</p><p><strong>URS</strong>：更新请求源 (Update request source) 该位由软件设置和清除，以选择UEV事件的请求源。</p><p>0：如果使能了中断或DMA，以下任一事件可以产生一个更新中断或DMA请求： - 计数器上溢或下溢 - 设置UG位 - 通过从模式控制器产生的更新</p><p>1：如果使能了中断或DMA，只有计数器上溢或下溢可以产生更新中断或DMA请求。</p><p><strong>UDIS</strong>：禁止更新 (Update disable)</p><p>该位由软件设置和清除，以使能或禁止UEV事件的产生。</p><p>0：UEV使能。更新事件(UEV)可以由下列事件产生： - 计数器上溢或下溢 - 设置UG位 - 通过从模式控制器产生的更新 产生更新事件后，带缓冲的寄存器被加载为预加载数值。</p><p>1：禁止UEV。不产生更新事件(UEV)，影子寄存器保持它的内容(ARR、PSC)。但是如果设置 了UG位或从模式控制器产生了一个硬件复位，则计数器和预分频器将被重新初始化。</p><p><strong>CEN</strong>：计数器使能 (Counter enable)</p><p>0：关闭计数器</p><p>1：使能计数器</p><p>注：门控模式只能在软件已经设置了CEN位时有效，而触发模式可以自动地由硬件设置CEN 位。 在单脉冲模式下，当产生更新事件时CEN被自动清除。</p><h5 id="控制寄存器2-timx-cr2" tabindex="-1"><a class="header-anchor" href="#控制寄存器2-timx-cr2"><span>控制寄存器2 - TIMx_CR2</span></a></h5><p><strong>MMS</strong>：主模式选择 (Master mode selection)</p><p>这些位用于选择在主模式下向从定时器发送的同步信息(TRGO)，有以下几种组合：</p><p>000：复位 – 使用TIMx_EGR寄存器的UG位作为触发输出(TRGO)。如果触发输入产生了复位 (从模式控制器配置为复位模式)，则相对于实际的复位信号，TRGO上的信号有一定的延迟。</p><p>001：使能 – 计数器使能信号CNT_EN被用作为触发输出(TRGO)。它可用于在同一时刻启动多 个定时器，或控制使能从定时器的时机。计数器使能信号是通过CEN控制位和配置为门控模式 时的触发输入的’逻辑或’产生。 当计数器使能信号是通过触发输入控制时，在TRGO输出上会有一些延迟，除非选择了主/从模 式(见TIMx_SMCR寄存器的MSM位)。</p><p>010：更新 – 更新事件被用作为触发输出(TRGO)。例如一个主定时器可以作为从定时器的预分 频器使用。</p><h5 id="dma-中断使能寄存器-timx-dier" tabindex="-1"><a class="header-anchor" href="#dma-中断使能寄存器-timx-dier"><span>DMA/中断使能寄存器 - TIMx_DIER</span></a></h5><p><strong>UDE</strong>：更新DMA请求使能 (Update DMA request enable)</p><p>0：禁止更新DMA请求 1：使能更新DMA请求</p><p><strong>UIE</strong>：更新中断使能 (Update interrupt enable)</p><p>0：禁止更新中断 1：使能更新中断</p><h5 id="状态寄存器-timx-sr" tabindex="-1"><a class="header-anchor" href="#状态寄存器-timx-sr"><span>状态寄存器 - TIMx_SR</span></a></h5><p><strong>UIF</strong>：更新中断标志 (Update interrupt flag)</p><p>硬件在更新中断时设置该位，它由软件清除。</p><p>0：没有产生更新。</p><p>1：产生了更新中断。下述情况下由硬件设置该位：</p><ul><li>计数器产生上溢或下溢并且TIMx_CR1中的UDIS=0；</li><li>如果TIMx_CR1中的URS=0并且UDIS=0，当使用TIMx_EGR寄存器的UG位重新初始化计数器CNT时。</li></ul><h5 id="事件产生寄存器-timx-egr" tabindex="-1"><a class="header-anchor" href="#事件产生寄存器-timx-egr"><span>事件产生寄存器 - TIMx_EGR</span></a></h5><p><strong>UG</strong>：产生更新事件 (Update generation)</p><p>该位由软件设置，由硬件自动清除。</p><p>0：无作用</p><p>1：重新初始化定时器的计数器并产生对寄存器的更新。注意：预分频器也被清除(但预分频系数不变)。</p><h5 id="计数器-timx-cnt" tabindex="-1"><a class="header-anchor" href="#计数器-timx-cnt"><span>计数器 - TIMx_CNT</span></a></h5><p><strong>CNT</strong>：计数器数值</p><h5 id="预分频器-timx-psc" tabindex="-1"><a class="header-anchor" href="#预分频器-timx-psc"><span>预分频器 - TIMx_PSC</span></a></h5><p><strong>PSC[15:0]</strong>：预分频器数值 (Prescaler value)</p><p>计数器的时钟频率CK_CNT等于fCK_PSC/(PSC[15:0]+1)。在每一次更新事件时，PSC的数值被传送到实际的预分频寄存器中。</p><h5 id="自动重装载寄存器-timx-arr" tabindex="-1"><a class="header-anchor" href="#自动重装载寄存器-timx-arr"><span>自动重装载寄存器 - TIMx_ARR</span></a></h5><p><strong>ARR[15:0]</strong>：自动重装载数值 (Prescaler value)</p><p>ARR的数值将传送到实际的自动重装载寄存器中。如果自动重装载数值为0，则计数器停止。</p><h1 id="通用定时器" tabindex="-1"><a class="header-anchor" href="#通用定时器"><span>通用定时器</span></a></h1><h2 id="通用定时器简介" tabindex="-1"><a class="header-anchor" href="#通用定时器简介"><span>通用定时器简介</span></a></h2><h2 id="通用定时器框图" tabindex="-1"><a class="header-anchor" href="#通用定时器框图"><span>通用定时器框图</span></a></h2><p><img src="'+r+'" alt="image-20250223214312332"></p><h2 id="通用定时器寄存器" tabindex="-1"><a class="header-anchor" href="#通用定时器寄存器"><span>通用定时器寄存器</span></a></h2><p><img src="'+t+'" alt="通用定时器框图"></p><h1 id="高级定时器" tabindex="-1"><a class="header-anchor" href="#高级定时器"><span>高级定时器</span></a></h1><h2 id="高级定时器简介" tabindex="-1"><a class="header-anchor" href="#高级定时器简介"><span>高级定时器简介</span></a></h2><h2 id="高级定时器框图" tabindex="-1"><a class="header-anchor" href="#高级定时器框图"><span>高级定时器框图</span></a></h2><h3 id="_0-总框图-1" tabindex="-1"><a class="header-anchor" href="#_0-总框图-1"><span>0.总框图</span></a></h3><p><img src="'+l+'" alt="image-20250222230209995"></p><h3 id="_1-时钟源-1" tabindex="-1"><a class="header-anchor" href="#_1-时钟源-1"><span>1.时钟源</span></a></h3><p>时钟来源有4种：内部时钟源（CK_INT）、外部时钟源TINx（x=1,2,3,4）、外部时钟源ETR、内部触发输入ITR</p><h4 id="外部时钟源tinx" tabindex="-1"><a class="header-anchor" href="#外部时钟源tinx"><span>外部时钟源TINx</span></a></h4><p>4个通道：TI1/2/3/4（TIMx_CH1/2/3/4）。</p><p>2个触发源：滤波后的定时器输入1 （TI1FP1）和滤波后的定时器输入2（TI2FP2）</p><p><img src="'+d+'" alt="image-20250222232421628"></p><h4 id="外部时钟源etr" tabindex="-1"><a class="header-anchor" href="#外部时钟源etr"><span>外部时钟源ETR</span></a></h4><p>1个通道：ETR（TIMx_ETR）</p><p>1个触发源：ETRP，滤波后连接至ETRF</p><p><img src="'+c+'" alt="image-20250222232726964"></p><h4 id="内部输入触发itr" tabindex="-1"><a class="header-anchor" href="#内部输入触发itr"><span>内部输入触发ITR</span></a></h4><p><img src="'+g+'" alt="image-20250223211052829"></p><h3 id="_2-控制器-1" tabindex="-1"><a class="header-anchor" href="#_2-控制器-1"><span>2.控制器</span></a></h3><p>触发控制器：针对片内外设输出触发信号，比如为其他定时器提供时钟和触发DAC/ADC转换。</p><p>从模式控制器：可以控制计数器复位、启动、递增/递减、计数。</p><p>编码器接口：针对编码器计数而设计。</p><h3 id="_3-时基单元" tabindex="-1"><a class="header-anchor" href="#_3-时基单元"><span>3.时基单元</span></a></h3><p>1个16位自动装载计数器</p><p>1个 16 位向上、向下、向上/向下计数器</p><p>1个16位可编程（可以实时修改）预分频器</p><p>1个16位计数器</p><p>1个16位重复次数寄存器，高级定时器专属，重复计数器是自动加载的 ，当向上溢出、向下溢出和中央 对其模式下每次上溢或下溢时，重复计数器的值递减。高级控制定时器只能在重复次数达到0的 时候产生更新事件。</p><h3 id="_4-5-输入捕获-输出比较" tabindex="-1"><a class="header-anchor" href="#_4-5-输入捕获-输出比较"><span>4/5.输入捕获/输出比较</span></a></h3><p><img src="'+m+'" alt="image-20250223141011548"></p><p><img src="'+o+'" alt="image-20250223144518942"></p><p><img src="'+x+'" alt="image-20250223144541346"></p><p><img src="'+f+'" alt="image-20250223144614150"></p><p>输入捕获模式、PWM输入模式、编码器接口模式。</p><p>强制输出模式、输出比较模式、PWM模式、互补输出和死区插入、单脉冲模式、断路功能</p><h3 id="_6-断路功能" tabindex="-1"><a class="header-anchor" href="#_6-断路功能"><span>6.断路功能</span></a></h3><p>断路功能就是电机的刹车功能。刹车源可以说是外部断路输入引脚，也可以是一个时钟失败事件（由复位时钟控制器的时钟安全系统产生）。</p><h2 id="高级定时器寄存器" tabindex="-1"><a class="header-anchor" href="#高级定时器寄存器"><span>高级定时器寄存器</span></a></h2><p><img src="'+b+'" alt="image-20250222233854900"></p>',105)])])}]]),T=JSON.parse('{"path":"/Embeded/10_Motor/11_TIMER.html","title":"定时器","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"定时器","description":"这是一个C语言基础页面"},"headers":[{"level":2,"title":"F1定时器定时器通道映射","slug":"f1定时器定时器通道映射","link":"#f1定时器定时器通道映射","children":[]},{"level":2,"title":"基础定时器简介","slug":"基础定时器简介","link":"#基础定时器简介","children":[]},{"level":2,"title":"基础定时器框图","slug":"基础定时器框图","link":"#基础定时器框图","children":[{"level":3,"title":"0.总框图","slug":"_0-总框图","link":"#_0-总框图","children":[]},{"level":3,"title":"1.时钟源","slug":"_1-时钟源","link":"#_1-时钟源","children":[]},{"level":3,"title":"2.控制器","slug":"_2-控制器","link":"#_2-控制器","children":[]},{"level":3,"title":"3.计数器","slug":"_3-计数器","link":"#_3-计数器","children":[]}]},{"level":2,"title":"基础定时器寄存器","slug":"基础定时器寄存器","link":"#基础定时器寄存器","children":[]},{"level":2,"title":"通用定时器简介","slug":"通用定时器简介","link":"#通用定时器简介","children":[]},{"level":2,"title":"通用定时器框图","slug":"通用定时器框图","link":"#通用定时器框图","children":[]},{"level":2,"title":"通用定时器寄存器","slug":"通用定时器寄存器","link":"#通用定时器寄存器","children":[]},{"level":2,"title":"高级定时器简介","slug":"高级定时器简介","link":"#高级定时器简介","children":[]},{"level":2,"title":"高级定时器框图","slug":"高级定时器框图","link":"#高级定时器框图","children":[{"level":3,"title":"0.总框图","slug":"_0-总框图-1","link":"#_0-总框图-1","children":[]},{"level":3,"title":"1.时钟源","slug":"_1-时钟源-1","link":"#_1-时钟源-1","children":[]},{"level":3,"title":"2.控制器","slug":"_2-控制器-1","link":"#_2-控制器-1","children":[]},{"level":3,"title":"3.时基单元","slug":"_3-时基单元","link":"#_3-时基单元","children":[]},{"level":3,"title":"4/5.输入捕获/输出比较","slug":"_4-5-输入捕获-输出比较","link":"#_4-5-输入捕获-输出比较","children":[]},{"level":3,"title":"6.断路功能","slug":"_6-断路功能","link":"#_6-断路功能","children":[]}]},{"level":2,"title":"高级定时器寄存器","slug":"高级定时器寄存器","link":"#高级定时器寄存器","children":[]}],"git":{"updatedTime":1760539161000,"contributors":[{"name":"malihang","username":"malihang","email":"mlh18@qq.com","commits":3,"url":"https://github.com/malihang"},{"name":"PC-20250430KOXD\\\\Administrator","username":"","email":"mlh18@qq.com","commits":3}],"changelog":[{"hash":"a7e80d0b3dc4a82ae0b60b48fd4014e3ad6533d4","time":1760539161000,"email":"mlh18@qq.com","author":"malihang","message":"pages首次更新"},{"hash":"4dce1d01322463aab33bfe8ce1fa832f9dd99da7","time":1760069147000,"email":"mlh18@qq.com","author":"PC-20250430KOXD\\\\Administrator","message":"更新Motor文件夹结构"},{"hash":"e7f9fd9b00f37c35761edf27741d327f233535bd","time":1758764510000,"email":"mlh18@qq.com","author":"PC-20250430KOXD\\\\Administrator","message":"调整motor文件结构"},{"hash":"946baf48328e295281569ce385b0cedfb75c880b","time":1749392583000,"email":"mlh18@qq.com","author":"malihang","message":"【提交人】MLH 【新增内容】增加F1定时器映射说明 【修改内容】无"},{"hash":"75cba30ff99113e1449579f0c945dddc805ec3c3","time":1747042444000,"email":"mlh18@qq.com","author":"PC-20250430KOXD\\\\Administrator","message":"【提交人】MLH 【新增内容】新增电机控制基础知识，调整文件结构 【修改内容】"},{"hash":"241f405aa4a1114dafb9512249d9583228225406","time":1740322224000,"email":"mlh18@qq.com","author":"malihang","message":"更新定时器相关知识点"}]},"filePathRelative":"Embeded/10_Motor/11_TIMER.md"}')}}]);